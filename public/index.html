<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>Video Player</title>

<script src="https://telegram.org/js/telegram-web-app.js?59"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box}

html,body{
  width:100%;
  height:100%;
  background:#000;
  overflow:hidden;
  font-family:system-ui,-apple-system,Segoe UI,sans-serif;
}

/* ================= PLAYER ROOT ================= */
#player{
  position:fixed;
  inset:0;
  background:#000;
}

/* ================= NORMAL MODE ================= */
#normalBox{
  position:absolute;
  inset:0;
}

/* ================= RED BOX (FULLSCREEN SAFE AREA) ================= */
#safeBox{
  position:absolute;
  top:48px; /* telegram header */
  bottom:0;
  left:0;
  right:0;
  background:#000;
  display:none;
  overflow:hidden;
}

/* ================= IFRAME ================= */
#playerFrame{
  position:absolute;
  width:100%;
  height:100%;
  border:none;
  background:#000;
}

/* ================= ROTATION ================= */
#safeBox.fullscreen #playerFrame{
  width:100vh;
  height:100vw;
  transform:rotate(90deg);
  transform-origin:center;
  top:50%;
  left:50%;
  translate:-50% -50%;
}

/* ================= CONTROLS ================= */
.ctrl{
  position:absolute;
  background:rgba(0,0,0,.6);
  border:none;
  color:#fff;
  font-size:20px;
  padding:6px 10px;
  border-radius:8px;
  z-index:10;
}

/* ---- normal mode button positions ---- */
#normalBack{ top:12px; left:12px; }
#normalFull{ bottom:12px; right:12px; }

/* ---- fullscreen (red box) positions ---- */
#fsBack{ top:10px; left:10px; }
#fsNormal{ bottom:10px; right:10px; }

/* ================= LOADER ================= */
#loader{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  color:#fff;
  font-size:14px;
  z-index:5;
}
</style>
</head>

<body>

<div id="player">

  <!-- NORMAL MODE -->
  <div id="normalBox">
    <iframe id="playerFrame"></iframe>

    <button id="normalBack" class="ctrl" onclick="goBack()">✕</button>
    <button id="normalFull" class="ctrl" onclick="enterFullscreen()">⛶</button>
  </div>

  <!-- FULLSCREEN RED BOX -->
  <div id="safeBox">
    <iframe id="fsFrame"></iframe>

    <button id="fsBack" class="ctrl" onclick="exitFullscreen()">✕</button>
    <button id="fsNormal" class="ctrl" onclick="exitFullscreen()">⤢</button>
  </div>

</div>

<script>
const tg = Telegram.WebApp;
tg.ready();
tg.expand();

const VIDEO_URL =
  "https://playterabox.com/embed/player?url=https://example.com/video.mp4";

/* init */
playerFrame.src = VIDEO_URL;
fsFrame.src = VIDEO_URL;

function enterFullscreen(){
  tg.requestFullscreen?.();
  tg.lockOrientation?.();

  normalBox.style.display="none";
  safeBox.style.display="block";
  safeBox.classList.add("fullscreen");
}

function exitFullscreen(){
  tg.exitFullscreen?.();
  tg.unlockOrientation?.();

  safeBox.classList.remove("fullscreen");
  safeBox.style.display="none";
  normalBox.style.display="block";
}

function goBack(){
  tg.close();
}
</script>

</body>
</html>
