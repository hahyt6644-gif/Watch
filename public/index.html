<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport"
content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>Watch Video</title>

<script src="https://telegram.org/js/telegram-web-app.js?59"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box}

html,body{
  width:100%;
  height:100%;
  background:#000;
  overflow:hidden;
  font-family:system-ui,-apple-system,Segoe UI,sans-serif;
}

/* ================= PLAYER ================= */
#player{
  display:none;
  position:fixed;
  inset:0;
  background:#000;
  z-index:999999;
}

/* ================= PLAYER BOX ================= */
#playerBox{
  position:absolute;
  inset:0;
  background:#000;
  overflow:hidden;
}

/* ================= IFRAME ================= */
#playerFrame{
  position:absolute;
  width:100%;
  height:100%;
  border:none;
  background:#000;
}

/* ================= FULLSCREEN (RED BOX) ================= */
#player.fullscreen{
  padding-top:48px; /* telegram header */
}

#player.fullscreen #playerBox{
  height:calc(100% - 48px);
}

#player.fullscreen #playerFrame{
  width:100vh;
  height:100vw;
  transform:rotate(90deg);
  transform-origin:center;
  top:50%;
  left:50%;
  translate:-50% -50%;
}

/* ================= CONTROLS ================= */
.ctrl{
  position:absolute;
  background:rgba(0,0,0,.6);
  border:none;
  color:#fff;
  font-size:20px;
  padding:6px 10px;
  border-radius:8px;
  z-index:10;
}

/* NORMAL MODE POSITIONS */
#btnBack{ top:12px; left:12px; }
#btnToggle{ bottom:12px; right:12px; }

/* FULLSCREEN POSITIONS (RED BOX) */
#player.fullscreen #btnBack{
  top:10px;
  left:10px;
}

#player.fullscreen #btnToggle{
  bottom:10px;
  right:10px;
}
</style>
</head>

<body>

<!-- PLAYER -->
<div id="player">
  <div id="playerBox">

    <iframe
      id="playerFrame"
      allow="autoplay; fullscreen"
      src="https://playterabox.com/embed/player?url=https://example.com/video.mp4">
    </iframe>

    <!-- CONTROLS -->
    <button id="btnBack" class="ctrl" onclick="goBack()">✕</button>
    <button id="btnToggle" class="ctrl" onclick="toggleFullscreen()">⛶</button>

  </div>
</div>

<script>
const tg = Telegram.WebApp;
tg.ready();
tg.expand();

let isFullscreen = false;

/* OPEN PLAYER */
function openPlayer(){
  player.style.display = "block";
  exitFullscreen();
}

/* BACK */
function goBack(){
  exitFullscreen();
  player.style.display = "none";
  tg.close?.();
}

/* FULLSCREEN TOGGLE */
function toggleFullscreen(){
  if(isFullscreen){
    exitFullscreen();
  }else{
    enterFullscreen();
  }
}

function enterFullscreen(){
  tg.requestFullscreen?.();
  tg.lockOrientation?.();
  player.classList.add("fullscreen");
  btnToggle.textContent = "⤢";
  isFullscreen = true;
}

function exitFullscreen(){
  tg.exitFullscreen?.();
  tg.unlockOrientation?.();
  player.classList.remove("fullscreen");
  btnToggle.textContent = "⛶";
  isFullscreen = false;
}

/* AUTO OPEN FOR TEST */
openPlayer();
</script>

</body>
</html>
