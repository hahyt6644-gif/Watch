<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">

<title>Video Player</title>

<!-- Telegram WebApp -->
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  background:#000;
  overflow:hidden;
  font-family:Arial,Helvetica,sans-serif;
}

/* ROOT PLAYER */
#player{
  position:fixed;
  inset:0;
  background:#000;
  display:flex;
  align-items:center;
  justify-content:center;
}

/* VIDEO CONTAINER */
#videoBox{
  position:relative;
  width:100%;
  max-width:720px;
  aspect-ratio:16/9;
  background:#000;
  transition:all .35s ease;
}

/* IFRAME */
#videoFrame{
  width:100%;
  height:100%;
  border:0;
  background:#000;
  transform-origin:center center;
  transition:transform .35s ease;
}

/* TOP CONTROLS */
.controls{
  position:absolute;
  top:8px;
  left:8px;
  right:8px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  z-index:50;
  pointer-events:none;
}

/* BUTTONS */
.btn{
  pointer-events:auto;
  background:rgba(0,0,0,.6);
  color:#fff;
  border-radius:20px;
  padding:6px 12px;
  font-size:13px;
  cursor:pointer;
  user-select:none;
  display:flex;
  align-items:center;
  gap:6px;
}

.btn:hover{ background:rgba(0,0,0,.85); }

/* FULLSCREEN MODE */
.fullscreen #videoBox{
  width:100vh;
  height:100vw;
  max-width:none;
  max-height:none;
}

.fullscreen #videoFrame{
  transform:rotate(90deg) scale(1.6);
}

/* NORMAL MODE */
.normal #videoFrame{
  transform:rotate(0deg) scale(1);
}
</style>
</head>

<body>

<div id="player" class="normal">

  <div id="videoBox">

    <!-- TOP BUTTONS -->
    <div class="controls">
      <div class="btn" onclick="goBack()">⬅ Back</div>
      <div class="btn" id="fsBtn" onclick="toggleFullscreen()">⛶ Fullscreen</div>
    </div>

    <!-- VIDEO -->
    <iframe
      id="videoFrame"
      allowfullscreen
      allow="autoplay; fullscreen"
    ></iframe>

  </div>
</div>

<script>
const tg = window.Telegram?.WebApp;
if(tg){
  tg.ready();
  tg.expand();
}

const params = new URLSearchParams(location.search);
const videoUrl = params.get("url");

const frame = document.getElementById("videoFrame");
const player = document.getElementById("player");
const fsBtn  = document.getElementById("fsBtn");

if(!videoUrl){
  alert("No video URL provided");
}else{
  frame.src = "https://playterabox.com/embed/player?url=" + encodeURIComponent(videoUrl);
}

/* FULLSCREEN TOGGLE */
function toggleFullscreen(){
  if(player.classList.contains("fullscreen")){
    exitFullscreen();
  }else{
    enterFullscreen();
  }
}

function enterFullscreen(){
  player.classList.remove("normal");
  player.classList.add("fullscreen");
  fsBtn.innerHTML = "⤢ Normal";

  if(tg?.requestFullscreen){
    tg.requestFullscreen();
  }
}

function exitFullscreen(){
  player.classList.remove("fullscreen");
  player.classList.add("normal");
  fsBtn.innerHTML = "⛶ Fullscreen";

  if(tg?.exitFullscreen){
    tg.exitFullscreen();
  }
}

/* BACK */
function goBack(){
  if(player.classList.contains("fullscreen")){
    exitFullscreen();
  }else{
    if(tg){
      tg.close();
    }else{
      history.back();
    }
  }
}

/* AUTO SYNC IF USER ROTATES DEVICE */
window.addEventListener("orientationchange",()=>{
  if(Math.abs(window.orientation) === 90){
    enterFullscreen();
  }else{
    exitFullscreen();
  }
});
</script>

</body>
</html>
